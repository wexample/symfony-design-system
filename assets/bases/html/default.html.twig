{%- extends '@SymfonyDesignSystemBundle/bases/base.html.twig' -%}

{%- import '@SymfonyDesignSystemBundle/macros/assets.html.twig' as macro_assets -%}

{%- block layout_base -%}
    {{- parent() -}}
    <!DOCTYPE html>
    <html lang="{{ app.request.locale }}">
    <head>
        <meta charset="utf-8"/>

            <script>
              "use strict";

              {# Use old school fashioned javascript notation to improve compatibility. -#}
              var AppRegistryBundlesManager = function AppRegistryBundlesManager() {
                this.classes = {};
              };

              AppRegistryBundlesManager.prototype = {
                add: function add(id, definition) {
                  {# Prevent class override. -#}
                  if (!this.classes[id]) {
                    this.classes[id] = definition;
                  }

                  var app = window.app;

                  if (!app) {
                    throw new Error("Unable to start app.");
                    return;
                  }

                  {# When app core is not loaded, -#}
                  {# js asset might be preloaded. -#}
                  if (app.hasCoreLoaded) {
                    {# Mark now that class is loaded. -#}
                    app.services.assets.jsPendingLoaded(id);
                  }

                  {# Return to allow export or extending class. -#}
                  return definition;
                }
              };

              window.appRegistry = {bundles: new AppRegistryBundlesManager()};
	    </script>
    </head>
    <body>

    <div id="layout" >
                            {{- block('page_body') -}}
    </div>
        {{ macro_assets.render_available_css(render_pass, 'layout') }}
        {{ macro_assets.render_available_js(render_pass, 'layout') }}

        <script type="text/javascript" src="{{ asset('build/runtime.js') }}"></script>
    </body>
    </html>
{%- endblock -%}
